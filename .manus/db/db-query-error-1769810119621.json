{
  "query": "CREATE TABLE `events` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`name` text NOT NULL,\n\t`slug` varchar(100) NOT NULL,\n\t`startsAt` timestamp,\n\t`endsAt` timestamp,\n\t`formSchema` json DEFAULT ('{\"fields\":[{\"key\":\"full_name\",\"label\":\"Name\",\"type\":\"text\",\"required\":true},{\"key\":\"email\",\"label\":\"Email\",\"type\":\"email\",\"required\":true},{\"key\":\"company_name\",\"label\":\"Company\",\"type\":\"text\",\"required\":false},{\"key\":\"role_title\",\"label\":\"Role\",\"type\":\"text\",\"required\":false},{\"key\":\"phone\",\"label\":\"Phone\",\"type\":\"tel\",\"required\":false},{\"key\":\"notes\",\"label\":\"Notes\",\"type\":\"textarea\",\"required\":false}]}'),\n\t`defaultIntent` text NOT NULL DEFAULT ('warm_intro'),\n\t`defaultTags` json DEFAULT ('[]'),\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `events_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `tenant_slug_unique` UNIQUE(`tenantId`,`slug`)\n);\n\nCREATE TABLE `integrations` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`provider` enum('google','amplemarket') NOT NULL,\n\t`status` enum('connected','disconnected','error') NOT NULL DEFAULT 'disconnected',\n\t`config` json DEFAULT ('{}'),\n\t`oauthTokens` json,\n\t`lastSyncedAt` timestamp,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `integrations_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `tenant_provider_unique` UNIQUE(`tenantId`,`provider`)\n);\n\nCREATE TABLE `moments` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`threadId` varchar(36) NOT NULL,\n\t`personId` varchar(36) NOT NULL,\n\t`source` text NOT NULL,\n\t`type` enum('email_sent','email_received','reply_received','call_completed','meeting_held','note_added','signal_detected','lead_captured') NOT NULL,\n\t`timestamp` timestamp NOT NULL,\n\t`metadata` json DEFAULT ('{}'),\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `moments_id` PRIMARY KEY(`id`)\n);\n\nCREATE TABLE `nextActions` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`threadId` varchar(36) NOT NULL,\n\t`actionType` text NOT NULL,\n\t`triggerType` text NOT NULL,\n\t`triggerValue` text NOT NULL,\n\t`status` enum('open','completed','cancelled') NOT NULL DEFAULT 'open',\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`completedAt` timestamp,\n\tCONSTRAINT `nextActions_id` PRIMARY KEY(`id`)\n);\n\nCREATE TABLE `people` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`fullName` text NOT NULL,\n\t`primaryEmail` varchar(320) NOT NULL,\n\t`secondaryEmails` json DEFAULT ('[]'),\n\t`companyName` text,\n\t`roleTitle` text,\n\t`phone` varchar(50),\n\t`tags` json DEFAULT ('[]'),\n\t`enrichmentSource` text,\n\t`enrichmentSnapshot` json,\n\t`enrichmentLastSyncedAt` timestamp,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `people_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `tenant_primary_email_unique` UNIQUE(`tenantId`,`primaryEmail`)\n);\n\nCREATE TABLE `tenants` (\n\t`id` varchar(36) NOT NULL,\n\t`name` text NOT NULL,\n\t`domain` text,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `tenants_id` PRIMARY KEY(`id`)\n);\n\nCREATE TABLE `threads` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`personId` varchar(36) NOT NULL,\n\t`source` text NOT NULL,\n\t`intent` text NOT NULL,\n\t`status` enum('active','dormant','closed') NOT NULL DEFAULT 'active',\n\t`title` text,\n\t`lastActivityAt` timestamp,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `threads_id` PRIMARY KEY(`id`)\n);\n\nALTER TABLE `users` DROP INDEX `users_openId_unique`;\nALTER TABLE `users` MODIFY COLUMN `id` varchar(36) NOT NULL;\nALTER TABLE `users` MODIFY COLUMN `email` varchar(320) NOT NULL;\nALTER TABLE `users` MODIFY COLUMN `role` enum('owner','collaborator','restricted') NOT NULL DEFAULT 'owner';\nALTER TABLE `users` ADD `tenantId` varchar(36) NOT NULL;\nALTER TABLE `users` ADD `passwordHash` text NOT NULL;\nALTER TABLE `users` ADD CONSTRAINT `tenant_email_unique` UNIQUE(`tenantId`,`email`);\n\nCREATE INDEX `tenant_thread_timestamp_idx` ON `moments` (`tenantId`,`threadId`,`timestamp`);\nCREATE INDEX `tenant_person_timestamp_idx` ON `moments` (`tenantId`,`personId`,`timestamp`);\nCREATE INDEX `tenant_status_idx` ON `nextActions` (`tenantId`,`status`);\nCREATE INDEX `tenant_thread_status_idx` ON `nextActions` (`tenantId`,`threadId`,`status`);\nCREATE INDEX `tenant_name_idx` ON `people` (`tenantId`,`fullName`);\nCREATE INDEX `domain_idx` ON `tenants` (`domain`);\nCREATE INDEX `tenant_person_idx` ON `threads` (`tenantId`,`personId`);\nCREATE INDEX `tenant_status_idx` ON `threads` (`tenantId`,`status`);\n\nALTER TABLE `users` DROP COLUMN `openId`;\nALTER TABLE `users` DROP COLUMN `name`;\nALTER TABLE `users` DROP COLUMN `loginMethod`;\nALTER TABLE `users` DROP COLUMN `updatedAt`;\nALTER TABLE `users` DROP COLUMN `lastSignedIn`;",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway03.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2QkRhwd4AVTLhHG.a0950ca1ba2f --database TQEsx2HByTQrcAiUBn2kww --execute CREATE TABLE `events` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`name` text NOT NULL,\n\t`slug` varchar(100) NOT NULL,\n\t`startsAt` timestamp,\n\t`endsAt` timestamp,\n\t`formSchema` json DEFAULT ('{\"fields\":[{\"key\":\"full_name\",\"label\":\"Name\",\"type\":\"text\",\"required\":true},{\"key\":\"email\",\"label\":\"Email\",\"type\":\"email\",\"required\":true},{\"key\":\"company_name\",\"label\":\"Company\",\"type\":\"text\",\"required\":false},{\"key\":\"role_title\",\"label\":\"Role\",\"type\":\"text\",\"required\":false},{\"key\":\"phone\",\"label\":\"Phone\",\"type\":\"tel\",\"required\":false},{\"key\":\"notes\",\"label\":\"Notes\",\"type\":\"textarea\",\"required\":false}]}'),\n\t`defaultIntent` text NOT NULL DEFAULT ('warm_intro'),\n\t`defaultTags` json DEFAULT ('[]'),\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `events_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `tenant_slug_unique` UNIQUE(`tenantId`,`slug`)\n);\n\nCREATE TABLE `integrations` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`provider` enum('google','amplemarket') NOT NULL,\n\t`status` enum('connected','disconnected','error') NOT NULL DEFAULT 'disconnected',\n\t`config` json DEFAULT ('{}'),\n\t`oauthTokens` json,\n\t`lastSyncedAt` timestamp,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `integrations_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `tenant_provider_unique` UNIQUE(`tenantId`,`provider`)\n);\n\nCREATE TABLE `moments` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`threadId` varchar(36) NOT NULL,\n\t`personId` varchar(36) NOT NULL,\n\t`source` text NOT NULL,\n\t`type` enum('email_sent','email_received','reply_received','call_completed','meeting_held','note_added','signal_detected','lead_captured') NOT NULL,\n\t`timestamp` timestamp NOT NULL,\n\t`metadata` json DEFAULT ('{}'),\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `moments_id` PRIMARY KEY(`id`)\n);\n\nCREATE TABLE `nextActions` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`threadId` varchar(36) NOT NULL,\n\t`actionType` text NOT NULL,\n\t`triggerType` text NOT NULL,\n\t`triggerValue` text NOT NULL,\n\t`status` enum('open','completed','cancelled') NOT NULL DEFAULT 'open',\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`completedAt` timestamp,\n\tCONSTRAINT `nextActions_id` PRIMARY KEY(`id`)\n);\n\nCREATE TABLE `people` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`fullName` text NOT NULL,\n\t`primaryEmail` varchar(320) NOT NULL,\n\t`secondaryEmails` json DEFAULT ('[]'),\n\t`companyName` text,\n\t`roleTitle` text,\n\t`phone` varchar(50),\n\t`tags` json DEFAULT ('[]'),\n\t`enrichmentSource` text,\n\t`enrichmentSnapshot` json,\n\t`enrichmentLastSyncedAt` timestamp,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `people_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `tenant_primary_email_unique` UNIQUE(`tenantId`,`primaryEmail`)\n);\n\nCREATE TABLE `tenants` (\n\t`id` varchar(36) NOT NULL,\n\t`name` text NOT NULL,\n\t`domain` text,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `tenants_id` PRIMARY KEY(`id`)\n);\n\nCREATE TABLE `threads` (\n\t`id` varchar(36) NOT NULL,\n\t`tenantId` varchar(36) NOT NULL,\n\t`personId` varchar(36) NOT NULL,\n\t`source` text NOT NULL,\n\t`intent` text NOT NULL,\n\t`status` enum('active','dormant','closed') NOT NULL DEFAULT 'active',\n\t`title` text,\n\t`lastActivityAt` timestamp,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `threads_id` PRIMARY KEY(`id`)\n);\n\nALTER TABLE `users` DROP INDEX `users_openId_unique`;\nALTER TABLE `users` MODIFY COLUMN `id` varchar(36) NOT NULL;\nALTER TABLE `users` MODIFY COLUMN `email` varchar(320) NOT NULL;\nALTER TABLE `users` MODIFY COLUMN `role` enum('owner','collaborator','restricted') NOT NULL DEFAULT 'owner';\nALTER TABLE `users` ADD `tenantId` varchar(36) NOT NULL;\nALTER TABLE `users` ADD `passwordHash` text NOT NULL;\nALTER TABLE `users` ADD CONSTRAINT `tenant_email_unique` UNIQUE(`tenantId`,`email`);\n\nCREATE INDEX `tenant_thread_timestamp_idx` ON `moments` (`tenantId`,`threadId`,`timestamp`);\nCREATE INDEX `tenant_person_timestamp_idx` ON `moments` (`tenantId`,`personId`,`timestamp`);\nCREATE INDEX `tenant_status_idx` ON `nextActions` (`tenantId`,`status`);\nCREATE INDEX `tenant_thread_status_idx` ON `nextActions` (`tenantId`,`threadId`,`status`);\nCREATE INDEX `tenant_name_idx` ON `people` (`tenantId`,`fullName`);\nCREATE INDEX `domain_idx` ON `tenants` (`domain`);\nCREATE INDEX `tenant_person_idx` ON `threads` (`tenantId`,`personId`);\nCREATE INDEX `tenant_status_idx` ON `threads` (`tenantId`,`status`);\n\nALTER TABLE `users` DROP COLUMN `openId`;\nALTER TABLE `users` DROP COLUMN `name`;\nALTER TABLE `users` DROP COLUMN `loginMethod`;\nALTER TABLE `users` DROP COLUMN `updatedAt`;\nALTER TABLE `users` DROP COLUMN `lastSignedIn`;",
  "returncode": 1,
  "logs": [
    "ERROR 1064 (42000) at line 1: You have an error in your SQL syntax; check the manual that corresponds to your TiDB version for the right syntax to use line 8 column 439 near \"'{\"fields\":[{\"key\":\"full_name\",\"label\":\"Name\",\"type\":\"text\",\"required\":true},{\"key\":\"email\",\"label\":\"Email\",\"type\":\"email\",\"required\":true},{\"key\":\"company_name\",\"label\":\"Company\",\"type\":\"text\",\"required\":false},{\"key\":\"role_title\",\"label\":\"Role\",\"type\":\"text\",\"required\":false},{\"key\":\"phone\",\"label\":\"Phone\",\"type\":\"tel\",\"required\":false},{\"key\":\"notes\",\"label\":\"N"
  ]
}